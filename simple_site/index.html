<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatApp & OCR AI</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            color: #2196f3;
            margin-bottom: 10px;
        }

        .subtitle {
            color: #666;
        }

        .main-content {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
        }

        @media (max-width: 992px) {
            .main-content {
                flex-direction: column;
            }
        }

        .section {
            flex: 1;
            background-color: #fff;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .section-header {
            background-color: #2196f3;
            color: white;
            padding: 15px;
            text-align: center;
        }

        .ocr-section .section-header {
            background-color: #4285f4;
        }

        iframe {
            width: 100%;
            height: 700px;
            border: none;
        }

        footer {
            text-align: center;
            padding: 20px;
            color: #666;
            background-color: #fff;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .debug-info {
            background-color: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 5px;
            padding: 10px;
            margin-bottom: 20px;
            font-size: 12px;
        }

        .url-list {
            text-align: left;
            margin-top: 10px;
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>ChatApp & OCR AI Platform</h1>
            <p class="subtitle">Integrated Chat and Document OCR Processing Applications</p>

            <div class="debug-info">
                <strong>Debug Info - URL-uri accesibile:</strong>
                <div class="url-list" id="urlList">
                    <div>Calculez URL-urile dinamice...</div>
                </div>
            </div>
        </header>

        <div class="main-content">
            <div class="section chat-section">
                <div class="section-header">
                    <h2>Real-time Chat Application</h2>
                </div>
                <iframe id="chatFrame" src="" title="Chat Application"></iframe>
            </div>

            <div class="section ocr-section">
                <div class="section-header">
                    <h2>Document OCR Processing</h2>
                </div>
                <iframe id="ocrFrame" src="" title="OCR Application"></iframe>
            </div>
        </div>

        <footer>
            <p>&copy; 2025 - ChatApp & OCR AI Platform</p>
        </footer>
    </div>

    <script>
        // Detectează automat IP-ul și porturile pentru Kubernetes
        function detectKubernetesUrls() {
            // Obține IP-ul din URL-ul curent (site-ul principal)
            const currentHost = window.location.hostname;

            // Porturile estimate pe baza configurării Kubernetes
            // Acestea ar trebui să fie porturile NodePort din kubectl get services
            const estimatedChatPort = '32753';  // chatapp-frontend-service NodePort
            const estimatedOcrPort = '32274';   // ocr-frontend-service NodePort
            const estimatedChatBackendPort = '30918'; // chatapp-backend-service NodePort
            const estimatedOcrBackendPort = '31991';  // ocr-backend-service NodePort

            const chatUrl = `http://${currentHost}:${estimatedChatPort}`;
            const ocrUrl = `http://${currentHost}:${estimatedOcrPort}`;

            return {
                chat: chatUrl,
                ocr: ocrUrl,
                chatBackend: `http://${currentHost}:${estimatedChatBackendPort}`,
                ocrBackend: `http://${currentHost}:${estimatedOcrBackendPort}`
            };
        }

        // Setează iframe-urile cu URL-urile detectate
        function setupIframes() {
            const urls = detectKubernetesUrls();

            // Setează src pentru iframe-uri
            document.getElementById('chatFrame').src = urls.chat;
            document.getElementById('ocrFrame').src = urls.ocr;

            // Afișează informațiile de debug
            document.getElementById('urlList').innerHTML = `
                <div><strong>Chat Frontend:</strong> ${urls.chat}</div>
                <div><strong>OCR Frontend:</strong> ${urls.ocr}</div>
                <div><strong>Chat Backend:</strong> ${urls.chatBackend}</div>
                <div><strong>OCR Backend:</strong> ${urls.ocrBackend}</div>
                <div><strong>Dacă nu funcționează, verifică porturile cu: kubectl get services</strong></div>
            `;
        }

        // Funcție pentru a testa conectivitatea
        function testConnectivity() {
            const urls = detectKubernetesUrls();

            // Test chat frontend
            fetch(urls.chat)
                .then(response => {
                    console.log('Chat Frontend:', response.ok ? 'OK' : 'ERROR');
                })
                .catch(err => console.log('Chat Frontend ERROR:', err));

            // Test OCR frontend
            fetch(urls.ocr)
                .then(response => {
                    console.log('OCR Frontend:', response.ok ? 'OK' : 'ERROR');
                })
                .catch(err => console.log('OCR Frontend ERROR:', err));
        }

        // Inițializează când pagina se încarcă
        document.addEventListener('DOMContentLoaded', function () {
            setupIframes();

            // Testează conectivitatea după 2 secunde
            setTimeout(testConnectivity, 2000);
        });

        // Reîmprospătează iframe-urile la cerere
        function refreshIframes() {
            setupIframes();
        }
    </script>
</body>

</html>